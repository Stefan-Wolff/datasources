PREFIX foaf:    <http://xmlns.com/foaf/0.1/>
PREFIX vivo:    <http://vivoweb.org/ontology/core#>



CONSTRUCT {

	?grant vivo:relates ?org .
	?org ?orgP ?orgO .
	?orgO ?orgPP ?prgOO .
	?orgOO ?orgPPP ?orgOOO .
	
	?grant vivo:relates ?role .
	?role ?roleP ?roleO .
	
} WHERE {

	?grant vivo:relates ?org .
	
	?org a foaf:Organization .
	?org ?orgP ?orgO .
	?orgO ?orgPP ?prgOO .
	?orgOO ?orgPPP ?orgOOO .
	
	# Here we add 2 lower-level triples ("?orgO..." and "?orgOO...") in order to retrieve the organization's vcards.
	# That is, because the individual sparql query for vcards, can only be used for high-level entities,
	# which are retrieved by our java code, as wheat-related.
	
	?grant vivo:relates ?role .

	FILTER NOT EXIST { ?role a foaf:Organization }
	?role ?roleP ?roleO .
}
